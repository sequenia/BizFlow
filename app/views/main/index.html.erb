<div ng-app='bizflow'>
<div ng-controller='bizFlowCtrl' class='container-fluid'>

    <div class="navbar">
        <div class="navbar-inner">
          <span class="brand"></span>
          <ul class="nav">
            <li>
              <form class="navbar-search pull-left">
                История: <input type="text" class="search-query" placeholder="Фильтр" ng-model="query">
              </form>
            </li>
          </ul>
        </div>
    </div>

    <div class='row-fluid' ng-repeat='old in history | filter:query'>
    <div class='span10'>
        <div class='history'>
            <div class='row-fluid'>
                <div ng-repeat='(label, input) in old.inputs' class='history-body span{{inputHistorySpanType(old.recipeName)}}'>
                    <h4>{{label}}</h4>
                    <h4>{{input.qty}}</h4>
                </div>
            </div>

            <div class='row-fluid history-body'>
              <h2>Операция: {{old.recipeName}}</h2>
            </div>

            <div class='row-fluid'>
                <div ng-repeat='(label, output) in old.outputs' class='history-body span{{outputHistorySpanType(old.recipeName)}}'>
                    <h4>{{label}}</h4>
                    <h4>{{output.qty}}</h4>
                </div>
            </div>
        </div>
    </div>
    <div class='span2 history'>
        <h4>Дата: {{old.date}}</h4>
    </div>
    </div>

    <div class='row-fluid' id='inputs'>
        <div ng-repeat='input in recipes[recipeName].inputs' class='span{{inputSpanType()}}'>
            <div class='cylinder-labels-oum'>{{input.UOM}}</div>
            <div cylinder type='input' label='{{getInputName(input)}}' proportion='{{input.pct}}' having='{{input.onHand}}' critical='{{input.critical}}'></div>
            <div class='arrow-input'></div>
        </div>
    </div>

    <div class='row-fluid mixer-body'>
        <div class='center-div'>
            <h2><b>Операция:</b></h2>
            <select ng-model='recipeName' ng-change='changeRounding()'>
                <option ng-repeat='recipe in recipes'>{{recipe.name}}</option>
            </select>
        </div>
    </div>

    <div class='row-fluid'>
        <div ng-repeat='output in recipes[recipeName].outputs' class='span{{outputSpanType()}}'>
            <div class='arrow-output'></div>
            <div class='cylinder-labels-oum'>{{output.UOM}}</div>
            <div cylinder type='output' label='{{getOutputName(output)}}' proportion='{{output.pct}}'></div>
        </div>
    </div>

    <div class='submit-container'>
        <form ng-submit="execute()">
              <input class='btn btn-default btn-lg' type='submit' value="{{loading && 'Загрузка...' || 'Пуск'}}" ng-disabled="executeButtonDisabled()">
        </form>
    </div>
</div>
</div>
